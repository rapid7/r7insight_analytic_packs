{
    "name": "Windows PCI Compliance",
    "searches": [
        {
            "name": "Invalid Logins",
            "description": "Logins with incorrect credentials",
            "query": "where(/4625/ OR /\s529/AND eventCode)"
        },
        {
            "name": "Admin Account Created",
            "description": "A user was added to the local Administrators group",
            "query": "where(/4732/ OR /\s636/AND eventCode)"
        },
        {
            "name": "Account Locked Out",
            "description": "Too many invalid logins attempts occurred",
            "query": "where(/4740/ OR /\s644/AND eventCode)"
        },
        {
            "name": "Audit Log Cleared",
            "description": "The Winodws Audit Log was cleared",
            "query": "where(/1102/ OR /\s517/AND eventCode)"
        },
        {
            "name": "Audit Policy Changed",
            "description": "The Windows Audit Policy was modified",
            "query": "where(/4719/ OR /\s612/AND eventCode)"
        },
        {
            "name": "Invalid Logins By Host",
            "description": "Provides a bar chart of the invalid logins, broken down by each host",
            "query": "where(/:\\d{2} (?P<host>\\w+)./ AND /4625/ OR /\s529/AND eventCode) groupby(host)"
        },
        {
            "name": "Admin Account Created by Host",
            "description": "Provides a bar chart of the Administrator accounts created, broken down by each host",
            "query": "where(/:\\d{2} (?P<host>\\w+)./ AND /4732/ OR /\s636/AND eventCode) groupby(host)"
        },
        {
            "name": "Accounts Locked Out by Host",
            "description": "Provides a bar chart of the number of accounts locked out, broken down by each host",
            "query": "where(/:\\d{2} (?P<host>\\w+)./ AND /4740/ OR /\s644/AND eventCode) groupby(host)"
        },
        {
            "name": "Audit Log Cleared by Host",
            "description": "Provides a bar chart of the Windows Audit Log Cleared events, broken down by each host",
            "query": "where(/:\\d{2} (?P<host>\\w+)./ AND /1102/ OR /\s517/AND eventCode) groupby(host)"
        },
        {
            "name": "Audit Policy Changed by Host",
            "description": "Provides a bar chart of the Windows Audit Policy Changed events, broken down by each host",
            "query": "where(/:\\d{2} (?P<host>\\w+)./ AND /4719/ OR /\s612/AND eventCode) groupby(host)"
        }
    ],
    "tags": [{
        "type": "Alert",
        "name": "Windows Failed Login",
        "description": "Windows Failed Login",
        "labels": [{
            "name": "Failed Login",
            "color": "660066"
        }],
        "patterns": [
            "/4625/ OR /\s529/AND eventCode"
        ],
        "actions": [{
            "type": "Alert",
            "min_matches_count": 1,
            "min_report_count": 1,
            "min_matches_period": "Hour",
            "min_report_period": "Hour"
        }]
    }, {
        "type": "Alert",
        "name": "Admin Account Created",
        "description": "Admin Account Created",
        "labels": [{
            "name": "Admin Created",
            "color": "660066"
        }],
        "patterns": [
            "/4732/ OR /\s636/AND eventCode"
        ],
        "actions": [{
            "type": "Alert",
            "min_matches_count": 1,
            "min_report_count": 1,
            "min_matches_period": "Hour",
            "min_report_period": "Hour"
        }]
    }, {
        "type": "Alert",
        "name": "Account Locked Out",
        "description": "Account Locked Out",
        "labels": [{
            "name": "Account Locked Out",
            "color": "660066"
        }],
        "patterns": [
            "/4740/ OR /\s644/AND eventCode"
        ],
        "actions": [{
            "type": "Alert",
            "min_matches_count": 1,
            "min_report_count": 1,
            "min_matches_period": "Hour",
            "min_report_period": "Hour"
        }]
    }, {
        "type": "Alert",
        "name": "Audit Log Cleared",
        "description": "Audit Log Cleared",
        "labels": [{
            "name": "Audit Log Cleared",
            "color": "660066"
        }],
        "patterns": [
            "/1102/ OR /\s517/AND eventCode"
        ],
        "actions": [{
            "type": "Alert",
            "min_matches_count": 1,
            "min_report_count": 1,
            "min_matches_period": "Hour",
            "min_report_period": "Hour"
        }]
    }, {
        "type": "Alert",
        "name": "Audit Policy Changed",
        "description": "Audit Policy Changed",
        "labels": [{
            "name": "Admin Created",
            "color": "660066"
        }],
        "patterns": [
            "/4719/ OR /\s612/AND eventCode"
        ],
        "actions": [{
            "type": "Alert",
            "min_matches_count": 1,
            "min_report_count": 1,
            "min_matches_period": "Hour",
            "min_report_period": "Hour"
        }]
    }
    ],
    "cards": [
        {
            "name": "Invalid Logins",
            "description":"Invalid Logins",
            "queries": [{ "leql" : {"statement": "where(/4625/ OR /\s529/AND eventCode) CALCULATE(COUNT)"}}],
            "visualization": "COUNT"
        },                                    
        {
            "name": "Admin Account Created",
            "description": "Admin Account Created",
            "queries": [{ "leql" : {"statement": "where(/4732/ OR /\s636/AND eventCode) CALCULATE(COUNT)"}}],
            "visualization": "COUNT"
        },                 
        {
            "name": "Account Locked Out",
            "description": "Account Locked Out",
            "queries": [{ "leql" : {"statement": "where(/4740/ OR /\s644/AND eventCode) CALCULATE(COUNT)"}}],
            "visualization": "COUNT"
        },                 
        {
            "name": "Audit Policy Changed",
            "description": "Audit Policy Changed",
            "queries": [{ "leql" : {"statement": "where(/4719/ OR /\s612/AND eventCode) CALCULATE(COUNT)"}}],
            "visualization": "COUNT"
        },
        {
            "name": "Audit Log Cleared",
            "description": "Audit Log Cleared",
            "queries": [{ "leql" : {"statement": "where(/1102/ OR /\s517/AND eventCode) CALCULATE(COUNT)"}}],
            "visualization": "COUNT"
        }
    ]
}
